port: 7890
socks-port: 7891

# Transparent proxy server port for Linux and macOS
# redir-port: 7892

mixed-port: 7890
allow-lan: false

mode: Rule
ipv6: false
log-level: info
unified-delay: true
tcp-concurrent: true

external-controller: :9090
external-ui-url: https://github.com/Zephyruso/zashboard/releases/latest/download/dist.zip
external-ui: ui
external-ui-name: zashboard

geodata-mode: false
geo-auto-update: true
geo-update-interval: 24
geox-url:
  geoip: https://ghp.ci/https://github.com/Sereinfy/ruleset_geodata/releases/download/clash/geoip.dat
  geosite: https://ghp.ci/https://github.com/Sereinfy/ruleset_geodata/releases/download/clash/geosite.dat
  mmdb: https://ghp.ci/https://github.com/Sereinfy/ruleset_geodata/releases/download/clash/Country.mmdb
  asn: https://ghp.ci/https://github.com/Sereinfy/ruleset_geodata/releases/download/clash/Country-ASN.mmdb
  
find-process-mode: strict
global-client-fingerprint: chrome

profile:
  store-selected: true
  store-fake-ip: true
  
dns:
  enable: true
  listen: 0.0.0.0:53
  ipv6: false
  enhanced-mode: fake-ip #redir-host
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - rule-set:fakeip-filter   
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  nameserver:
    - https://doh.pub/dns-query#proxy
    - https://dns.alidns.com/dns-query
  fallback:
    - https://1.1.1.1/dns-query
    - https://185.222.222.222/dns-query
  proxy-server-nameserver:
    - tls://101.101.101.101
  nameserver-policy:
    '+.makima.online': '223.5.5.5'
tun:
  enable: true  # enable 'true'
  stack: system  # or 'gvisor'
  dns-hijack:
    - "any:53"
  auto-route: true
  auto-redirect: true
  auto-detect-interface: true

sniffer:
  enable: false
  sniff:
    TLS:
      ports: [443, 8443]
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
       
listeners:
- name: socks-in
  type: socks
  port: 10808
  proxy: æœºåœºé€‰æ‹©
    
proxies:


# é”šç‚¹å¼•ç”¨
rule-anchor:
  # è‡ªåŠ¨æµ‹é€Ÿ
  testUrl: &testUrl {url: "http://www.gstatic.com/generate_204", interval: 300}
  autoAll: &autoAll {type: url-test, include-all: true, hidden: false, <<: *testUrl}
  # å¥åº·æ£€æŸ¥
  Check: &Check {type: http, interval: 3600, health-check: {enable: true, <<: *testUrl}}
  # è¿œç¨‹å‚æ•°
  Classical: &classic {type: http, interval: 86400, behavior: classical}
  ipcidr: &ip {type: http, interval: 86400, behavior: ipcidr}
  domain: &domain {type: http, interval: 86400, behavior: domain, format: mrs}
  # æ‰‹åŠ¨é€‰æ‹©
  selectvps: &selectvps {type: select, <<: *testUrl, use: [MyVps], include-all-proxies: true, proxies: [æœºåœºé€‰æ‹©,DIRECT]}
  # æœºåœºé€‰æ‹©
  selectCity: &selectCity {type: select, <<: *testUrl, include-all-providers: true, proxies: [é¦™æ¸¯è‡ªåŠ¨,å°æ¹¾è‡ªåŠ¨,æ—¥æœ¬è‡ªåŠ¨,æ–°åŠ å¡è‡ªåŠ¨,ç¾Žå›½è‡ªåŠ¨,æ¬§ç›Ÿè‡ªåŠ¨]}
  selectAll: &selectAll {type: select, include-all-providers: true, proxies: [æ‰‹åŠ¨é€‰æ‹©,é¦™æ¸¯è‡ªåŠ¨,å°æ¹¾è‡ªåŠ¨,æ—¥æœ¬è‡ªåŠ¨,æ–°åŠ å¡è‡ªåŠ¨,ç¾Žå›½è‡ªåŠ¨,æ¬§ç›Ÿè‡ªåŠ¨,DIRECT,PASS]}
  # èŠ‚ç‚¹è¿‡æ»¤
  Exclude: &Exclude {exclude-filter: å¥ˆé£ž|æŽ¨è|è¿‡æœŸ|å‰©ä½™|åˆ°æœŸ|å®˜ç½‘|å¤±è”|å›žå›½|ç¾¤|é•¿æœŸ|é‡ç½®|ä½™é¢|å……å€¼|æ°ªé‡‘|å¥—é¤|é™åˆ¶}
  # åœ°åŒºè¿‡æ»¤
  filterHK: &filterHK {<<: *autoAll, filter: "(?i)(?!ç›´è¿ž)(é¦™æ¸¯|ðŸ‡­ðŸ‡°|hk|hongkong|hong kong|HKG)"}
  filterTW: &filterTW {<<: *autoAll, filter: "(?i)(?!ç›´è¿ž)(å°æ¹¾|ðŸ‡¼ðŸ‡¸|ðŸ‡¹ðŸ‡¼|TW|taiwan|TPE|TSA|KHH)"}
  filterJP: &filterJP {<<: *autoAll, filter: "(?i)(?!ç›´è¿ž)(æ—¥æœ¬|ä¸œäº¬|ðŸ‡¯ðŸ‡µ|JP|Japan|NRT|HND|KIX|CTS|FUK)"}
  filterUS: &filterUS {<<: *autoAll, filter: "(?i)(?!ç›´è¿ž)(ç¾Žå›½|ðŸ‡ºðŸ‡¸|æ´›æ‰çŸ¶|åœ£ä½•å¡ž|çº½çº¦|å‡¤å‡°åŸŽ|us|unitedstates|united states)"}
  filterSG: &filterSG {<<: *autoAll, filter: "(?i)(?!ç›´è¿ž)(æ–°åŠ å¡|ðŸ‡¸ðŸ‡¬|sg|singapore)"}
  filterNL: &filterNL {<<: *autoAll, filter: "(?i)(?!ç›´è¿ž)(è·å…°|ðŸ‡³ðŸ‡±|nl|Netherlands)"}
  FilterEU: &FilterEU {<<: *autoAll, filter: "(?i)(?!ç›´è¿ž)(æ¬§ç›Ÿ|å¥¥åœ°åˆ©|æ¯”åˆ©æ—¶|ä¿åŠ åˆ©äºš|å…‹ç½—åœ°äºš|å¡žæµ¦è·¯æ–¯|æ·å…‹å…±å’Œå›½|ä¸¹éº¦|çˆ±æ²™å°¼äºš|èŠ¬å…°|æ³•å›½|å¾·å›½|å¸Œè…Š|åŒˆç‰™åˆ©|çˆ±å°”å…°|æ„å¤§åˆ©|æ‹‰è„±ç»´äºš|ç«‹é™¶å®›|å¢æ£®å ¡|é©¬è€³ä»–|è·å…°|æ³¢å…°|è‘¡è„ç‰™|ç½—é©¬å°¼äºš|æ–¯æ´›ä¼å…‹|æ–¯æ´›æ–‡å°¼äºš|è¥¿ç­ç‰™|ç‘žå…¸|Austria|Belgium|Bulgaria|Croatia|Cyprus|Czech Republic|Denmark|Estonia|Finland|France|Germany|Greece|Hungary|Ireland|Italy|Latvia|Lithuania|Luxembourg|Malta|Netherlands|Poland|Portugal|Romania|Slovakia|Slovenia|Spain|Sweden|ðŸ‡§ðŸ‡ª|ðŸ‡¨ðŸ‡¿|ðŸ‡©ðŸ‡°|ðŸ‡«ðŸ‡®|ðŸ‡«ðŸ‡·|ðŸ‡©ðŸ‡ª|ðŸ‡®ðŸ‡ª|ðŸ‡®ðŸ‡¹|ðŸ‡±ðŸ‡¹|ðŸ‡±ðŸ‡º|ðŸ‡³ðŸ‡±|ðŸ‡µðŸ‡±|ðŸ‡¸ðŸ‡ª|ðŸ‡¬ðŸ‡§|CDG|FRA|AMS|MAD|BCN|FCO|MUC|BRU)"}
proxy-providers:
  # æ²¡æœ‰è‡ªå»ºä¸ç”¨å¡«
  MyVps: {<<: [*Check,*Exclude], url: ""} 
  
  # æœºåœºè®¢é˜…
  name:
    <<: [*Check,*Exclude]
#    filter: é¦™æ¸¯|æ–°åŠ å¡
    url: "https://bujidao.cc/sub?key=kdzvR3zKR05oVO7yT55y8IsSngwJyOoC"
    override:
      additional-prefix: "[]"

  
proxy-groups:
  - {name: æ‰‹åŠ¨é€‰æ‹©, <<: *selectvps, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Proxy.png}
  - {name: æœºåœºé€‰æ‹©, <<: *selectCity, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Airport.png}
  - {name: Twitter, <<: *selectAll, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Twitter.png}
  - {name: Telegram, <<: *selectAll, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram.png}
  - {name: TGæ¬§ç›Ÿ, type: select, proxies: [æ¬§ç›Ÿè‡ªåŠ¨,è·å…°è‡ªåŠ¨], icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram_X.png}
  - {name: Google, <<: *selectAll, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Google_Search.png}
  - {name: AI, <<: *selectAll, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Bot.png}
  - {name: YouTube, <<: *selectAll, icon: https://raw.githubusercontent.com/Sereinfy/clash/main/icons/YouTube2.png}
  - {name: AppleProxy,<<: *selectAll, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple_2.png}
  - {name: CloudflareIP,<<: *selectAll, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Cloudflare.png}
  - {name: æ¼ç½‘ä¹‹é±¼, <<: *selectAll, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Final.png }
  - {name: Akamai, <<: *selectAll, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Azure.png}
  - {name: Pikpak, <<: *selectAll, icon: https://raw.githubusercontent.com/Sereinfy/clash/main/icons/Pikpakre.png}
  - {name: å…¨çƒäº’è”, <<: *selectAll, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Global.png}
  - {name: å›½å†…ç›´è¿ž, type: select, proxies: [DIRECT,æ‰‹åŠ¨é€‰æ‹©], icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/China.png}
  - {name: å¹¿å‘Šæ‹¦æˆª, type: select, proxies: [REJECT,DIRECT], icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Reject.png}

  #åˆ†éš”,ä¸‹é¢æ˜¯åœ°åŒºåˆ†ç»„
  - {name: é¦™æ¸¯è‡ªåŠ¨, <<: *filterHK, icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png"}
  - {name: å°æ¹¾è‡ªåŠ¨, <<: *filterTW, icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Taiwan.png"}
  - {name: æ—¥æœ¬è‡ªåŠ¨, <<: *filterJP, icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png"}
  - {name: ç¾Žå›½è‡ªåŠ¨, <<: *filterUS, icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png"}
  - {name: æ–°åŠ å¡è‡ªåŠ¨, <<: *filterSG, icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png"}
  - {name: è·å…°è‡ªåŠ¨, <<: *filterNL, icon: "https://raw.githubusercontent.com/Sereinfy/clash/main/icons/Netherlands.png"}
  - {name: æ¬§ç›Ÿè‡ªåŠ¨, <<: *FilterEU, icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/European_Union.png"}
rules:
  - AND,((DST-PORT,443),(NETWORK,UDP),(NOT,((OR,(GEOSITE,cn),(GEOIP,cn,no-resolve))))),REJECT-DROP # å±è”½å›½å¤–quic
  - AND,((NETWORK,UDP),(DOMAIN-REGEX,(?i)stun|turn)),REJECT-DROP
  - AND,((DOMAIN-KEYWORD,bili),(DOMAIN-REGEX,(?i)pcdn|mcdn)),REJECT
  - OR,((DOMAIN-SUFFIX,akamai.net),(DOMAIN-SUFFIX,akamaized.net)),Akamai
  - OR,((DOMAIN-KEYWORD,fuliba),(DOMAIN-KEYWORD,wnflb)),æ‰‹åŠ¨é€‰æ‹©
  - OR,((DOMAIN-KEYWORD,zgocloud),(DOMAIN-KEYWORD,zgovps)),å›½å†…ç›´è¿ž
  - DOMAIN-SUFFIX,makima.online,å›½å†…ç›´è¿ž
  - DOMAIN-SUFFIX,imagestwist.com,æ‰‹åŠ¨é€‰æ‹©
  - DOMAIN-SUFFIX,geo2.adobe.com,REJECT-DROP
  - DOMAIN-SUFFIX,in.applicationinsights.azure.com,REJECT-DROP
  - RULE-SET,pikpak,Pikpak,no-resolve
  - RULE-SET,Adblock,å¹¿å‘Šæ‹¦æˆª,no-resolve
  - RULE-SET,LAN,å›½å†…ç›´è¿ž,no-resolve
  - RULE-SET,Tracker,å›½å†…ç›´è¿ž,no-resolve
  - RULE-SET,applications,å›½å†…ç›´è¿ž,no-resolve
  - RULE-SET,domestic_non_ip,å›½å†…ç›´è¿ž,no-resolve
  - RULE-SET,Google,Google,no-resolve
  - RULE-SET,Google_cn,Google,no-resolve
  - RULE-SET,YouTube,YouTube,no-resolve
  - RULE-SET,Twitter,Twitter,no-resolve
  - RULE-SET,GitHub,æ‰‹åŠ¨é€‰æ‹©,no-resolve
  - RULE-SET,AppleProxy,AppleProxy,no-resolve
  - RULE-SET,AI,AI,no-resolve
  - RULE-SET,China,å›½å†…ç›´è¿ž,no-resolve #LoyalsoldieråŒ…å« Microsoft_cn Apple_cn Google_cn
  - RULE-SET,Global,å…¨çƒäº’è”,no-resolve
  - RULE-SET,Telegram,Telegram,no-resolve
  - RULE-SET,telegram_SG,æ–°åŠ å¡è‡ªåŠ¨,no-resolve
  - RULE-SET,telegram_US,ç¾Žå›½è‡ªåŠ¨,no-resolve
  - RULE-SET,telegram_EU,TGæ¬§ç›Ÿ,no-resolve
  - RULE-SET,ChinaIP,å›½å†…ç›´è¿ž
  - RULE-SET,Cloudflare,CloudflareIP
  - MATCH,æ¼ç½‘ä¹‹é±¼

rule-providers: 
  domestic_non_ip: {<<: *classic, format: text, url: https://ruleset.skk.moe/Clash/non_ip/domestic.txt}
  applications: {<<: *classic, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/applications.yaml}
  LAN: {<<: *classic, url: https://ghfast.top/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Lan/Lan.yaml}
  Tracker: {<<: *classic, url: https://ghfast.top/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/PrivateTracker/PrivateTracker.yaml}
  pikpak: {<<: *classic, format: text, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/clash/refs/heads/main/rules/pikpak.list}
  fakeip-filter: {<<: *domain, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/fakeip-filter.mrs}
  Google: {<<: *domain, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/google.mrs}
  Google_cn: {<<: *domain, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/google-cn.mrs}
  GitHub: {<<: *domain, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/github.mrs}
  Twitter: {<<: *domain, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/twitter.mrs}
  YouTube: {<<: *domain, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/youtube.mrs}
  AI: {<<: *domain, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/ai.mrs}
  Global: {<<: *domain, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/proxy.mrs}
  AppleProxy: {<<: *domain, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/appleProxy.mrs}
  Adblock: {<<: *domain, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/ads.mrs}
  China: {<<: *domain, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/cn.mrs}
  ChinaIP: {<<: *ip, format: mrs, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/cnip.mrs}
  Cloudflare: {<<: *ip, format: mrs, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/cloudflareip.mrs}
  Telegram: {<<: *ip, format: mrs, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/ruleset_geodata/clash-ruleset/telegramip.mrs}
  telegram_SG: {<<: *ip, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/clash/main/rules/telegram-SG.yaml}
  telegram_US: {<<: *ip, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/clash/main/rules/telegram-US.yaml}
  telegram_EU: {<<: *ip, url: https://ghfast.top/https://raw.githubusercontent.com/Sereinfy/clash/main/rules/telegram-EU.yaml}
